-- SET datestyle = dmy;
DROP TABLE IF EXISTS DDOS;

CREATE TABLE DDOS (
	ID			INTEGER,
	Flow_ID 		VARCHAR(50),
	Src_IP			VARCHAR(15),
	Src_Port		INTEGER,
	Dst_IP			VARCHAR(15),
	Dst_Port		INTEGER,
	Protocol		INTEGER,
	Timestamp		CHAR(22),
	Flow_Duration		INTEGER,
	Tot_Fwd_Pkts		INTEGER,
	Tot_Bwd_Pkts		INTEGER,
	TotLen_Fwd_Pkts		REAL,
	TotLen_Bwd_Pkts		REAL,
	Fwd_Pkt_Len_Max		REAL,
	Fwd_Pkt_Len_Min		REAL,
	Fwd_Pkt_Len_Mean	REAL,
	Fwd_Pkt_Len_Std		REAL,
	Bwd_Pkt_Len_Max		REAL,
	Bwd_Pkt_Len_Min		REAL,
	Bwd_Pkt_Len_Mean	REAL,
	Bwd_Pkt_Len_Std		REAL,
	Flow_Byts_s		REAL,
	Flow_Pkts_s		REAL,
	Flow_IAT_Mean		REAL,
	Flow_IAT_Std		REAL,
	Flow_IAT_Max		REAL,
	Flow_IAT_Min		REAL,
	Fwd_IAT_Tot		REAL,
	Fwd_IAT_Mean		REAL,
	Fwd_IAT_Std		REAL,
	Fwd_IAT_Max		REAL,
	Fwd_IAT_Min		REAL,
	Bwd_IAT_Tot		REAL,
	Bwd_IAT_Mean		REAL,
	Bwd_IAT_Std		REAL,
	Bwd_IAT_Max		REAL,
	Bwd_IAT_Min		REAL,
	Fwd_PSH_Flags		INTEGER,
	Bwd_PSH_Flags		INTEGER,
	Fwd_URG_Flags		INTEGER,
	Bwd_URG_Flags		INTEGER,
	Fwd_Header_Len		INTEGER,
	Bwd_Header_Len		INTEGER,
	Fwd_Pkts_s		REAL,
	Bwd_Pkts_s		REAL,
	Pkt_Len_Min		REAL,
	Pkt_Len_Max		REAL,
	Pkt_Len_Mean		REAL,
	Pkt_Len_Std		REAL,
	Pkt_Len_Var		REAL,
	FIN_Flag_Cnt		INTEGER,
	SYN_Flag_Cnt		INTEGER,
	RST_Flag_Cnt		INTEGER,
	PSH_Flag_Cnt		INTEGER,
	ACK_Flag_Cnt		INTEGER,
	URG_Flag_Cnt		INTEGER,
	CWE_Flag_Count		INTEGER,
	ECE_Flag_Cnt		INTEGER,
	Down_Up_Ratio		REAL,
	Pkt_Size_Avg		REAL,
	Fwd_Seg_Size_Avg	REAL,
	Bwd_Seg_Size_Avg	REAL,
	Fwd_Byts_b_Avg		REAL,
	Fwd_Pkts_b_Avg		REAL,
	Fwd_Blk_Rate_Avg	REAL,
	Bwd_Byts_b_Avg		REAL,
	Bwd_Pkts_b_Avg		REAL,
	Bwd_Blk_Rate_Avg	REAL,
	Subflow_Fwd_Pkts	INTEGER,
	Subflow_Fwd_Byts	INTEGER,
	Subflow_Bwd_Pkts	INTEGER,
	Subflow_Bwd_Byts	INTEGER,
	Init_Fwd_Win_Byts	INTEGER,
	Init_Bwd_Win_Byts	INTEGER,
	Fwd_Act_Data_Pkts	INTEGER,
	Fwd_Seg_Size_Min	INTEGER,
	Active_Mean		REAL,
	Active_Std		REAL,
	Active_Max		REAL,
	Active_Min		REAL,
	Idle_Mean		REAL,
	Idle_Std		REAL,
	Idle_Max		REAL,
	Idle_Min		REAL,
	Label			VARCHAR(6)
);

.mode csv
.import '| tail -n +2 /path/to/ddos.csv' DDOS

UPDATE DDOS SET Flow_Byts_s = NULL WHERE Flow_Byts_s = '';
UPDATE DDOS SET Flow_Pkts_s = NULL WHERE Flow_Pkts_s = '';
