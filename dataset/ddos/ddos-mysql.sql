DROP TABLE IF EXISTS DDOS;

CREATE TABLE DDOS (
	ID			INTEGER,
	Flow_ID 		VARCHAR(50),
	Src_IP			VARCHAR(15),
	Src_Port		INTEGER,
	Dst_IP			VARCHAR(15),
	Dst_Port		INTEGER,
	Protocol		INTEGER,
	Timestamp		CHAR(22),
	Flow_Duration		INTEGER,
	Tot_Fwd_Pkts		INTEGER,
	Tot_Bwd_Pkts		INTEGER,
	TotLen_Fwd_Pkts		DECIMAL(15,2),
	TotLen_Bwd_Pkts		DECIMAL(15,2),
	Fwd_Pkt_Len_Max		DECIMAL(15,2),
	Fwd_Pkt_Len_Min		DECIMAL(15,2),
	Fwd_Pkt_Len_Mean	DECIMAL(15,2),
	Fwd_Pkt_Len_Std		DECIMAL(15,2),
	Bwd_Pkt_Len_Max		DECIMAL(15,2),
	Bwd_Pkt_Len_Min		DECIMAL(15,2),
	Bwd_Pkt_Len_Mean	DECIMAL(15,2),
	Bwd_Pkt_Len_Std		DECIMAL(15,2),
	Flow_Byts_s		DECIMAL(15,2),
	Flow_Pkts_s		DECIMAL(15,2),
	Flow_IAT_Mean		DECIMAL(15,2),
	Flow_IAT_Std		DECIMAL(15,2),
	Flow_IAT_Max		DECIMAL(15,2),
	Flow_IAT_Min		DECIMAL(15,2),
	Fwd_IAT_Tot		DECIMAL(15,2),
	Fwd_IAT_Mean		DECIMAL(15,2),
	Fwd_IAT_Std		DECIMAL(15,2),
	Fwd_IAT_Max		DECIMAL(15,2),
	Fwd_IAT_Min		DECIMAL(15,2),
	Bwd_IAT_Tot		DECIMAL(15,2),
	Bwd_IAT_Mean		DECIMAL(15,2),
	Bwd_IAT_Std		DECIMAL(15,2),
	Bwd_IAT_Max		DECIMAL(15,2),
	Bwd_IAT_Min		DECIMAL(15,2),
	Fwd_PSH_Flags		INTEGER,
	Bwd_PSH_Flags		INTEGER,
	Fwd_URG_Flags		INTEGER,
	Bwd_URG_Flags		INTEGER,
	Fwd_Header_Len		INTEGER,
	Bwd_Header_Len		INTEGER,
	Fwd_Pkts_s		DECIMAL(15,2),
	Bwd_Pkts_s		DECIMAL(15,2),
	Pkt_Len_Min		DECIMAL(15,2),
	Pkt_Len_Max		DECIMAL(15,2),
	Pkt_Len_Mean		DECIMAL(15,2),
	Pkt_Len_Std		DECIMAL(15,2),
	Pkt_Len_Var		DECIMAL(15,2),
	FIN_Flag_Cnt		INTEGER,
	SYN_Flag_Cnt		INTEGER,
	RST_Flag_Cnt		INTEGER,
	PSH_Flag_Cnt		INTEGER,
	ACK_Flag_Cnt		INTEGER,
	URG_Flag_Cnt		INTEGER,
	CWE_Flag_Count		INTEGER,
	ECE_Flag_Cnt		INTEGER,
	Down_Up_Ratio		DECIMAL(15,2),
	Pkt_Size_Avg		DECIMAL(15,2),
	Fwd_Seg_Size_Avg	DECIMAL(15,2),
	Bwd_Seg_Size_Avg	DECIMAL(15,2),
	Fwd_Byts_b_Avg		DECIMAL(15,2),
	Fwd_Pkts_b_Avg		DECIMAL(15,2),
	Fwd_Blk_Rate_Avg	DECIMAL(15,2),
	Bwd_Byts_b_Avg		DECIMAL(15,2),
	Bwd_Pkts_b_Avg		DECIMAL(15,2),
	Bwd_Blk_Rate_Avg	DECIMAL(15,2),
	Subflow_Fwd_Pkts	INTEGER,
	Subflow_Fwd_Byts	INTEGER,
	Subflow_Bwd_Pkts	INTEGER,
	Subflow_Bwd_Byts	INTEGER,
	Init_Fwd_Win_Byts	INTEGER,
	Init_Bwd_Win_Byts	INTEGER,
	Fwd_Act_Data_Pkts	INTEGER,
	Fwd_Seg_Size_Min	INTEGER,
	Active_Mean		DECIMAL(15,2),
	Active_Std		DECIMAL(15,2),
	Active_Max		DECIMAL(15,2),
	Active_Min		DECIMAL(15,2),
	Idle_Mean		DECIMAL(15,2),
	Idle_Std		DECIMAL(15,2),
	Idle_Max		DECIMAL(15,2),
	Idle_Min		DECIMAL(15,2),
	Label			VARCHAR(6)
);

SET GLOBAL local_infile = 'ON';
SHOW GLOBAL VARIABLES LIKE 'local_infile';

LOAD DATA LOCAL INFILE '/home/ubuntu/scripts/ddos.csv' INTO TABLE `DDOS` FIELDS TERMINATED BY ',' ENCLOSED BY '\"' LINES TERMINATED BY '\n' IGNORE 1 LINES;
-- LOAD DATA LOCAL INFILE '/home/ubuntu/scripts/ddos.csv' INTO TABLE `DDOS` FIELDS TERMINATED BY ',' ENCLOSED BY '\"' LINES TERMINATED BY '\n' IGNORE 1 LINES
-- (ID,Flow_ID,Src_IP,Src_Port,Dst_IP,Dst_Port,Protocol,@time_stamp,Flow_Duration,Tot_Fwd_Pkts,Tot_Bwd_Pkts,TotLen_Fwd_Pkts,TotLen_Bwd_Pkts,Fwd_Pkt_Len_Max,Fwd_Pkt_Len_Min,Fwd_Pkt_Len_Mean,Fwd_Pkt_Len_Std,Bwd_Pkt_Len_Max,Bwd_Pkt_Len_Min,Bwd_Pkt_Len_Mean,Bwd_Pkt_Len_Std,Flow_Byts_s,Flow_Pkts_s,Flow_IAT_Mean,Flow_IAT_Std,Flow_IAT_Max,Flow_IAT_Min,Fwd_IAT_Tot,Fwd_IAT_Mean,Fwd_IAT_Std,Fwd_IAT_Max,Fwd_IAT_Min,Bwd_IAT_Tot,Bwd_IAT_Mean,Bwd_IAT_Std,Bwd_IAT_Max,Bwd_IAT_Min,Fwd_PSH_Flags,Bwd_PSH_Flags,Fwd_URG_Flags,Bwd_URG_Flags,Fwd_Header_Len,Bwd_Header_Len,Fwd_Pkts_s,Bwd_Pkts_s,Pkt_Len_Min,Pkt_Len_Max,Pkt_Len_Mean,Pkt_Len_Std,Pkt_Len_Var,FIN_Flag_Cnt,SYN_Flag_Cnt,RST_Flag_Cnt,PSH_Flag_Cnt,ACK_Flag_Cnt,URG_Flag_Cnt,CWE_Flag_Count,ECE_Flag_Cnt,Down_Up_Ratio,Pkt_Size_Avg,Fwd_Seg_Size_Avg,Bwd_Seg_Size_Avg,Fwd_Byts_b_Avg,Fwd_Pkts_b_Avg,Fwd_Blk_Rate_Avg,Bwd_Byts_b_Avg,Bwd_Pkts_b_Avg,Bwd_Blk_Rate_Avg,Subflow_Fwd_Pkts,Subflow_Fwd_Byts,Subflow_Bwd_Pkts,Subflow_Bwd_Byts,Init_Fwd_Win_Byts,Init_Bwd_Win_Byts,Fwd_Act_Data_Pkts,Fwd_Seg_Size_Min,Active_Mean,Active_Std,Active_Max,Active_Min,Idle_Mean,Idle_Std,Idle_Max,Idle_Min,Label)
-- SET Timestamp=STR_TO_DATE(@time_stamp, '%d/%m/%Y %h:%i:%s %p');

